#
# Author: github.com/luncliff (luncliff@gmail.com)
#
# References
#   https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops#passing-parameters
#

jobs:
  - job: vs${{ parameters.visualstudio }}_cmake_ninja_clang_8
    pool:
      vmImage: ${{ parameters.vm_image }}
    steps:
      - task: PowerShell@2
        inputs:
          # https://chocolatey.org/packages/llvm/8.0.1
          targetType: "inline"
          script: choco install llvm --version=8.0.1 --yes --force --no-progress
      - task: ChocolateyCommand@0
        inputs:
          command: "install"
          installPackageId: "ninja"
          installInstallArgs: "--no-progress --yes"
      - task: BatchScript@1
        inputs:
          filename: "./scripts/build-vs${{ parameters.visualstudio }}-cmake-clang.bat"
        env:
          SHARED: ${{ parameters.build_shared }}
          BUILD_TYPE: ${{ parameters.configuration }}
        

  - job: vs${{ parameters.visualstudio }}_cmake_ninja_clang_latest
    pool:
      vmImage: ${{ parameters.vm_image }}
    steps:
      - task: ChocolateyCommand@0
        inputs:
          command: "install"
          installPackageId: "llvm"
          installInstallArgs: "--no-progress --yes"
      - task: ChocolateyCommand@0
        inputs:
          command: "install"
          installPackageId: "ninja"
          installInstallArgs: "--no-progress --yes"
      - task: BatchScript@1
        inputs:
          filename: "./scripts/build-vs${{ parameters.visualstudio }}-cmake-clang.bat"
        env:
          SHARED: ${{ parameters.make_shared }}
          BUILD_TYPE: ${{ parameters.configuration }}
